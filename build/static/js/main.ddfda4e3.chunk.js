(this["webpackJsonpslack-clone"]=this["webpackJsonpslack-clone"]||[]).push([[0],{267:function(e,t,n){},392:function(e,t,n){"use strict";n.r(t);var a=n(15),s=n(16),r=n(18),i=n(17),o=n(0),c=n.n(o),l=n(69),d=n.n(l),u=n(424),h=(n(267),n(173));n(268),n(270),n(393);h.a.initializeApp({apiKey:"AIzaSyD7SF7xDhB4Z3e6FSrh3Bm-P_Z7M_hcOWM",authDomain:"notify-slack.firebaseapp.com",projectId:"notify-slack",storageBucket:"notify-slack.appspot.com",messagingSenderId:"736375886643",appId:"1:736375886643:web:2d1932159fa12fdeaa6446",measurementId:"G-LYLF267PNT"});var j=new h.a.auth.GoogleAuthProvider,p=h.a,m=n(34),f="SET_USER",v="CLEAR_USER",g="SET_CURRENT_CHANNEL",b="SET_PRIVATE_CHANNEL",O="SET_USER_POSTS",y="SET_COLORS",x=function(e){return{type:g,payload:{currentChannel:e}}},C=function(e){return{type:b,payload:{isPrivateChannel:e}}},S=n(406),k=n(420),w=n(411),R=n(395),U=n(414),P=n(423),N=n(130),L=n(72),E=n(201),A=n(409),I=n(1),M=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={modal:!1,primary:"",secondary:"",user:e.props.currentUser,usersRef:p.database().ref("users"),userColors:[]},e.removeListener=function(){var t;e.state.usersRef.child("".concat(null===(t=e.state.user)||void 0===t?void 0:t.uid,"/colors")).off()},e.addListener=function(t){var n=[];e.state.usersRef.child("".concat(t,"/colors")).on("child_added",(function(t){n.unshift(t.val()),e.setState({userColors:n})}))},e.handleChangePrimary=function(t){return e.setState({primary:t.hex})},e.handleChangeSecondary=function(t){return e.setState({secondary:t.hex})},e.handleSaveColors=function(){e.state.primary&&e.state.secondary&&e.saveColors(e.state.primary,e.state.secondary)},e.saveColors=function(t,n){var a;e.state.usersRef.child("".concat(null===(a=e.state.user)||void 0===a?void 0:a.uid,"/colors")).push().update({primary:t,secondary:n}).then((function(){console.log("Colors added"),e.closeModal()})).catch((function(e){return console.error(e)}))},e.displayUserColors=function(t){return t.length>0&&t.map((function(t,n){return Object(I.jsxs)(c.a.Fragment,{children:[Object(I.jsx)(S.a,{}),Object(I.jsx)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"color__container",onClick:function(){return e.props.setColors(t.primary,t.secondary)},children:Object(I.jsx)("div",{className:"color__square",style:{background:t.primary},children:Object(I.jsx)("div",{className:"color__overlay",style:{background:t.secondary}})})})]},n)}))},e.openModal=function(){return e.setState({modal:!0})},e.closeModal=function(){return e.setState({modal:!1})},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e;this.state.user&&this.addListener(null===(e=this.state.user)||void 0===e?void 0:e.uid)}},{key:"componentWillUnmount",value:function(){this.removeListener()}},{key:"render",value:function(){var e=this.state,t=e.modal,n=e.primary,a=e.secondary,s=e.userColors;return Object(I.jsxs)(k.a,{as:w.a,icon:"labeled",inverted:!0,vertical:!0,visible:!0,width:"very thin",children:[Object(I.jsx)(S.a,{}),Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[Object(I.jsx)(R.a,{icon:"add",size:"small",color:"blue",onClick:this.openModal}),this.displayUserColors(s)]}),Object(I.jsxs)(U.a,{basic:!0,open:t,onClose:this.closeModal,className:"color_modal",children:[Object(I.jsx)(U.a.Header,{children:"Choose App Colors"}),Object(I.jsx)(U.a.Content,{children:Object(I.jsxs)(P.a,{inverted:!0,className:"ui horizontal segments",children:[Object(I.jsxs)(P.a,{inverted:!0,children:[Object(I.jsx)(N.a,{content:"Primary Color"}),Object(I.jsx)(E.a,{className:"sketch_picker",color:n,onChange:this.handleChangePrimary})]}),Object(I.jsxs)(P.a,{inverted:!0,children:[Object(I.jsx)(N.a,{content:"Secondary Color"}),Object(I.jsx)(E.a,{className:"sketch_picker",color:a,onChange:this.handleChangeSecondary})]})]})}),Object(I.jsxs)(U.a.Actions,{children:[Object(I.jsxs)(R.a,{color:"green",inverted:!0,onClick:this.handleSaveColors,children:[Object(I.jsx)(L.a,{name:"checkmark"})," Save Colors"]}),Object(I.jsxs)(R.a,{color:"red",inverted:!0,onClick:this.closeModal,children:[Object(I.jsx)(L.a,{name:"remove"})," Cancel"]})]})]})]})}}]),n}(c.a.Component),_=Object(m.b)(null,{setColors:function(e,t){return{type:y,payload:{primaryColor:e,secondaryColor:t}}}})(M),T=n(36),F=n(244),D=n.n(F),V=n(425),z=n(250),W=n(410),B=n(407),H=n(412),q=n(417),G=n.p+"static/media/slack.ddd06f0d.svg",K=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={user:e.props.currentUser,modal:!1,modal2:!1,previewImage:"",croppedImage:"",blob:null,uploadedCroppedImage:"",storageRef:p.storage().ref(),userRef:p.auth().currentUser,usersRef:p.database().ref("users"),channelRef:p.database().ref("channel"),metadata:{contentType:"image/jpeg"},username:"",errors:[],channel:e.props.currentChannel,messagesRef:p.database().ref("messages")},e.openModal=function(){return e.setState({modal:!0})},e.closeModal=function(){return e.setState({modal:!1})},e.openModal2=function(){return e.setState({modal2:!0})},e.closeModal2=function(){return e.setState({modal2:!1})},e.dropdownOptions=function(){var t;return[{key:"user",text:Object(I.jsxs)("span",{children:["Signed in as ",Object(I.jsx)("strong",{children:null===(t=e.state.user)||void 0===t?void 0:t.displayName})]}),disabled:!0},{key:"avatar",text:Object(I.jsx)("span",{onClick:e.openModal,children:"Change Avatar"})},{key:"editprofile",text:Object(I.jsx)("span",{onClick:e.openModal2,children:"Change Username"})},{key:"signout",text:Object(I.jsx)("span",{onClick:e.handleSignout,children:"Sign Out"})}]},e.uploadCroppedImage=function(){var t=e.state,n=t.storageRef,a=t.userRef,s=t.blob,r=t.metadata;n.child("avatars/users/".concat(a.uid)).put(s,r).then((function(t){t.ref.getDownloadURL().then((function(t){e.setState({uploadedCroppedImage:t},(function(){return e.changeAvatar()}))}))}))},e.changeAvatar=function(){var t,n;e.state.userRef.updateProfile({photoURL:e.state.uploadedCroppedImage}).then((function(){console.log("PhotoURL updated"),e.closeModal()})).catch((function(e){console.error(e)})),e.state.usersRef.child(null===(t=e.state.user)||void 0===t?void 0:t.uid).update({avatar:e.state.uploadedCroppedImage}).then((function(){console.log("User avatar updated")})).catch((function(e){console.error(e)})),e.state.channelRef.child(null===(n=e.state.channel)||void 0===n?void 0:n.id).child("createdBy").update({avatar:e.state.uploadedCroppedImage}).then((function(){return console.log("channel-username updated")})).catch((function(e){return console.error(e)}))},e.handleChange=function(t){var n=t.target.files[0],a=new FileReader;n&&(a.readAsDataURL(n),a.addEventListener("load",(function(){e.setState({previewImage:a.result})})))},e.handleCropImage=function(){e.avatarEditor&&e.avatarEditor.getImageScaledToCanvas().toBlob((function(t){var n=URL.createObjectURL(t);e.setState({croppedImage:n,blob:t})}))},e.handleSignout=function(){p.auth().signOut().then((function(){return console.log("signed out!")}))},e.isFormValid=function(){var t;return!e.isFormEmpty(e.state)||(t={message:"Username Can't Empty"},e.setState({errors:[].concat(t)}),!1)},e.isFormEmpty=function(e){return!e.username.length},e.editProfile=function(t){t.preventDefault(),e.isFormValid()&&(e.setState({errors:[]}),e.updateProfile())},e.updateProfile=function(){var t,n;e.state.userRef.updateProfile({displayName:e.state.username}).then((function(){console.log("redux username updated"),e.closeModal2()})).catch((function(e){return console.error(e)})),e.state.usersRef.child(null===(t=e.state.user)||void 0===t?void 0:t.uid).update({name:e.state.username}).then((function(){console.log("database username updated")})).catch((function(e){console.error(e)})),e.state.channelRef.child(null===(n=e.state.channel)||void 0===n?void 0:n.id).child("createdBy").update({name:e.state.username}).then((function(){return console.log("channel-username updated")})).catch((function(e){return console.error(e)}))},e.handleInputChange=function(t){e.setState(Object(T.a)({},t.target.name,t.target.value))},e.displayErrors=function(e){return e.map((function(e,t){return Object(I.jsx)("p",{children:e.message},t)}))},e.handleInputError=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t)}))?"error":""},e.iconVariants={hidden:{opacity:0},visible:{opacity:1,rotate:[0,0,270,270,0],transition:{delay:.5,duration:2}}},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.user,a=t.modal,s=t.previewImage,r=t.croppedImage,i=t.modal2,o=t.username,c=t.errors,l=this.props.primaryColor;return Object(I.jsx)(u.a,{style:{background:l},children:Object(I.jsxs)(u.a.Column,{children:[Object(I.jsxs)(u.a.Row,{style:{padding:"1.2em",margin:0},children:[Object(I.jsxs)(V.a,{inverted:!0,floated:"left",as:"h3",children:[Object(I.jsx)(z.a,{src:G,className:"slack__img"}),Object(I.jsx)(V.a.Content,{className:"size",children:"Notify-Slack"})]}),Object(I.jsx)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.7},children:Object(I.jsx)(V.a,{style:{padding:"0.25em"},as:"h4",inverted:!0,children:Object(I.jsx)(W.a,{trigger:Object(I.jsxs)("span",{children:[Object(I.jsx)(z.a,{src:null===n||void 0===n?void 0:n.photoURL,spaced:"right",avatar:!0}),null===n||void 0===n?void 0:n.displayName]}),options:this.dropdownOptions()})})})]}),Object(I.jsxs)(U.a,{basic:!0,open:a,onClose:this.closeModal,children:[Object(I.jsx)(U.a.Header,{children:"Change Avatar"}),Object(I.jsxs)(U.a.Content,{children:[Object(I.jsx)(B.a,{onChange:this.handleChange,fluid:!0,type:"file",label:"New Avatar",name:"previewImage"}),Object(I.jsx)(u.a,{centered:!0,stackable:!0,columns:2,children:Object(I.jsxs)(u.a.Row,{centered:!0,children:[Object(I.jsx)(u.a.Column,{className:"ui center aligned grid",children:s&&Object(I.jsx)(D.a,{ref:function(t){return e.avatarEditor=t},image:s,width:120,height:120,border:50,scale:1.2})}),Object(I.jsx)(u.a.Column,{children:r&&Object(I.jsx)(z.a,{style:{margin:"3.5em auto"},width:100,height:100,src:r})})]})})]}),Object(I.jsxs)(U.a.Actions,{children:[r&&Object(I.jsxs)(R.a,{color:"green",inverted:!0,onClick:this.uploadCroppedImage,children:[Object(I.jsx)(L.a,{name:"save"})," Change Avatar"]}),Object(I.jsxs)(R.a,{color:"green",inverted:!0,onClick:this.handleCropImage,children:[Object(I.jsx)(L.a,{name:"image"})," Preview"]}),Object(I.jsxs)(R.a,{color:"red",inverted:!0,onClick:this.closeModal,children:[Object(I.jsx)(L.a,{name:"remove"})," Cancel"]})]})]}),Object(I.jsxs)(U.a,{open:i,onClose:this.closeModal2,children:[Object(I.jsx)(U.a.Header,{children:"Edit Profile"}),Object(I.jsx)(U.a.Content,{children:Object(I.jsx)(H.a,{onSubmit:this.editProfile,children:Object(I.jsx)(H.a.Input,{fluid:!0,name:"username",value:o,onChange:this.handleInputChange,className:this.handleInputError(c,"username"),icon:"user",iconPosition:"left",placeholder:"New Username",required:!0})})}),Object(I.jsxs)(U.a.Actions,{children:[Object(I.jsxs)(R.a,{color:"green",inverted:!0,onClick:this.editProfile,children:[Object(I.jsx)(L.a,{name:"checkmark"})," Edit Profile"]}),Object(I.jsxs)(R.a,{color:"red",inverted:!0,onClick:this.closeModal2,children:[Object(I.jsx)(L.a,{name:"remove"})," Cancel"]})]}),c.length>0&&Object(I.jsxs)(q.a,{error:!0,children:[Object(I.jsx)("h3",{children:"Error"}),this.displayErrors(c)]})]})]})})}}]),n}(c.a.Component),Z=Object(m.b)((function(e){return{currentUser:e.user.currentUser}}))(K),Y=n(96),$=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={user:e.props.currentUser,channels:[],channel:null,notifications:[],modal:!1,channelName:"",channelDetails:"",errors:[],firstLoad:!0,activeChannel:"",channelRef:p.database().ref("channel"),messagesRef:p.database().ref("messages"),typingRef:p.database().ref("typing")},e.addListener=function(){var t=[];e.state.channelRef.on("child_added",(function(n){t.push(n.val()),e.setState({channels:t},(function(){return e.setFirstChannel()})),e.getNotificationListener(n.key)}))},e.getNotificationListener=function(t){e.state.messagesRef.child(t).on("value",(function(n){e.state.channel&&e.handleNotifications(t,e.state.channel.id,e.state.notifications,n)}))},e.handleNotifications=function(t,n,a,s){var r=0,i=a.findIndex((function(e){return e.id===t}));-1!==i?(t!==n&&(r=a[i].total,s.numChildren()-r>0&&(a[i].count=s.numChildren()-r)),a[i].lastKnownTotal=s.numChildren()):a.push({id:t,total:s.numChildren(),lastKnownTotal:s.numChildren(),count:0}),e.setState({notifications:a})},e.setFirstChannel=function(){var t=e.state.channels[0];e.state.firstLoad&&e.state.channels.length>0&&(e.props.setCurrentChannel(t),e.activeChannel(t),e.setState({channel:t})),e.setState({firstLoad:!1})},e.removeListener=function(){e.state.channelRef.off()},e.closeModal=function(){return e.setState({modal:!1})},e.openModal=function(){return e.setState({modal:!0})},e.addChannel=function(){var t=e.state,n=t.channelRef,a=t.channelDetails,s=t.channelName,r=t.user,i=n.push().key,o={id:i,name:s,details:a,createdBy:{name:null===r||void 0===r?void 0:r.displayName,avatar:null===r||void 0===r?void 0:r.photoURL}};n.child(i).update(o).then((function(){e.setState({channelName:"",channelDetails:""}),e.closeModal(),console.log("channel added")})).catch((function(e){return console.error(e)}))},e.displayErrors=function(e){return e.map((function(e,t){return Object(I.jsx)("p",{children:e.message},t)}))},e.handleInputError=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t)}))?"error":""},e.isFormValid=function(){var t;return e.isFormEmpty(e.state)?(t={message:"Fill in all fields"},e.setState({errors:[].concat(t)}),!1):(e.setState({errors:[]}),!0)},e.isFormEmpty=function(e){var t=e.channelName,n=e.channelDetails;return t&&n},e.handleChange=function(t){e.setState(Object(T.a)({},t.target.name,t.target.value))},e.handleSubmit=function(t){t.preventDefault(),e.isFormValid(e.state)&&(e.setState({errors:[]}),e.addChannel())},e.changeChannel=function(t){var n,a;e.activeChannel(t),e.state.typingRef.child(null===(n=e.state.channel)||void 0===n?void 0:n.id).child(null===(a=e.state.user)||void 0===a?void 0:a.uid).remove(),e.clearNotifications(),e.props.setCurrentChannel(t),e.props.setPrivateChannel(!1),e.setState({channel:t})},e.clearNotifications=function(){var t=e.state.notifications.findIndex((function(t){return t.id===e.state.channel.id}));if(-1!==t){var n=Object(Y.a)(e.state.notifications);n[t].total=e.state.notifications[t].lastKnownTotal,n[t].count=0,e.setState({notifications:n})}},e.activeChannel=function(t){e.setState({activeChannel:t.id})},e.displayChannel=function(t){return t.length>0&&t.map((function(t){return Object(I.jsxs)(w.a.Item,{onClick:function(){return e.changeChannel(t)},name:t.name,style:{opacity:.8},active:t.id===e.state.activeChannel,children:[e.getNotificationCount(t)&&Object(I.jsx)(N.a,{color:"red",children:e.getNotificationCount(t)}),Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:2},children:["# ",t.name]})]},t.id)}))},e.getNotificationCount=function(t){var n=0;if(e.state.notifications.forEach((function(e){t.id===e.id&&(n=e.count)})),n>0)return n},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.addListener()}},{key:"componentWillUnmount",value:function(){this.removeListener()}},{key:"render",value:function(){var e=this.state,t=e.channels,n=e.modal,a=e.channelDetails,s=e.channelName,r=e.errors;return Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(w.a.Menu,{className:"menu",children:[Object(I.jsx)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.7},children:Object(I.jsxs)(w.a.Item,{children:[Object(I.jsxs)("span",{children:[Object(I.jsx)(L.a,{name:"exchange"}),"CHANNELS"]})," ","(",t.length,")",Object(I.jsx)(L.a,{name:"add",onClick:this.openModal})]})}),this.displayChannel(t),Object(I.jsxs)(U.a,{basic:!0,open:n,onClose:this.closeModal,children:[Object(I.jsx)(U.a.Header,{children:"Add a Channel"}),Object(I.jsx)(U.a.Content,{children:Object(I.jsxs)(H.a,{onClick:this.handleSubmit,children:[Object(I.jsx)(H.a.Field,{children:Object(I.jsx)(B.a,{fluid:!0,label:"Channel Name",name:"channelName",onChange:this.handleChange,className:this.handleInputError(r,"channelName"),value:s})}),Object(I.jsx)(H.a.Field,{children:Object(I.jsx)(B.a,{fluid:!0,label:"About the Channel",name:"channelDetails",onChange:this.handleChange,className:this.handleInputError(r,"channelDetails"),value:a})})]})}),Object(I.jsxs)(U.a.Actions,{children:[Object(I.jsxs)(R.a,{color:"green",inverted:!0,onClick:this.handleSubmit,children:[Object(I.jsx)(L.a,{name:"checkmark"}),"Add"]}),Object(I.jsxs)(R.a,{color:"red",inverted:!0,onClick:this.closeModal,children:[Object(I.jsx)(L.a,{name:"remove"}),"Cancel"]})]}),r.length>0&&Object(I.jsx)(q.a,{error:!0,children:this.displayErrors(r)})]})]})})}}]),n}(o.Component),J=Object(m.b)(null,{setCurrentChannel:x,setPrivateChannel:C})($),Q=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activeChannel:"",user:e.props.currentUser,users:[],usersRef:p.database().ref("users"),connectedRef:p.database().ref(".info/connected"),presenceRef:p.database().ref("presence")},e.removeListeners=function(){e.state.usersRef.off(),e.state.connectedRef.off(),e.state.presenceRef.off()},e.addListeners=function(t){var n=[];e.state.usersRef.on("child_added",(function(a){if(t!==a.key){var s=a.val();s.uid=a.key,s.status="offline",n.push(s),e.setState({users:n})}})),e.state.connectedRef.on("value",(function(n){if(!0===n.val()){var a=e.state.presenceRef.child(t);a.set(!0),a.onDisconnect().remove((function(e){null!==e&&console.error(e)}))}})),e.state.presenceRef.on("child_added",(function(n){t!==n.key&&e.addStatusToUser(n.key)})),e.state.presenceRef.on("child_removed",(function(n){t!==n.key&&e.addStatusToUser(n.key,!1)}))},e.addStatusToUser=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=e.state.users.reduce((function(e,a){return a.uid===t&&(a.status="".concat(n?"online":"offline")),e.concat(a)}),[]);e.setState({users:a})},e.isUserOnline=function(e){return"online"===e.status},e.changeChannel=function(t){var n={id:e.getChannelId(null===t||void 0===t?void 0:t.uid),name:null===t||void 0===t?void 0:t.name};e.props.setCurrentChannel(n),e.props.setPrivateChannel(!0),e.setActiveChannel(null===t||void 0===t?void 0:t.uid)},e.getChannelId=function(t){var n,a=null===(n=e.state.user)||void 0===n?void 0:n.uid;return t<a?"".concat(t,"/").concat(a):"".concat(a,"/").concat(t)},e.setActiveChannel=function(t){e.setState({activeChannel:t})},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e;this.state.user&&this.addListeners(null===(e=this.state.user)||void 0===e?void 0:e.uid)}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"render",value:function(){var e=this,t=this.state,n=t.users,a=t.activeChannel;return Object(I.jsxs)(w.a.Menu,{className:"menu",children:[Object(I.jsx)(w.a.Item,{children:Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.7},children:[Object(I.jsxs)("span",{children:[Object(I.jsx)(L.a,{name:"mail"})," DIRECT MESSAGES"]})," ","(",n.length,")"]})}),n.map((function(t){return Object(I.jsxs)(w.a.Item,{active:(null===t||void 0===t?void 0:t.uid)===a,onClick:function(){return e.changeChannel(t)},style:{opacity:.7,fontStyle:"italic"},children:[Object(I.jsx)(L.a,{name:"circle",color:e.isUserOnline(t)?"green":"red"}),Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:2},children:["@ ",null===t||void 0===t?void 0:t.name]})]},t.uid)}))]})}}]),n}(c.a.Component),X=Object(m.b)(null,{setCurrentChannel:x,setPrivateChannel:C})(Q),ee=n(53),te=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activeChannel:"",starredChannels:[],user:e.props.currentUser,usersRef:p.database().ref("users")},e.removeListener=function(){var t;e.state.usersRef.child("".concat(null===(t=e.state.user)||void 0===t?void 0:t.uid,"/starred")).off()},e.addListener=function(t){e.state.usersRef.child(t).child("starred").on("child_added",(function(t){var n=Object(ee.a)({id:t.key},t.val());e.setState({starredChannels:[].concat(Object(Y.a)(e.state.starredChannels),[n])})})),e.state.usersRef.child(t).child("starred").on("child_removed",(function(t){var n=Object(ee.a)({id:t.key},t.val()),a=e.state.starredChannels.filter((function(e){return e.id!==n.id}));e.setState({starredChannels:a})}))},e.changeChannel=function(t){e.activeChannel(t),e.props.setCurrentChannel(t),e.props.setPrivateChannel(!1)},e.activeChannel=function(t){e.setState({activeChannel:t.id})},e.displayChannel=function(t){return t.length>0&&t.map((function(t){return Object(I.jsx)(w.a.Item,{onClick:function(){return e.changeChannel(t)},name:t.name,style:{opacity:.8},active:t.id===e.state.activeChannel,children:Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:2},children:["# ",t.name]})},t.id)}))},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.state.user&&this.addListener(this.state.user.uid)}},{key:"componentWillUnmount",value:function(){this.removeListener()}},{key:"render",value:function(){var e=this.state.starredChannels;return Object(I.jsxs)(w.a.Menu,{className:"menu",children:[Object(I.jsx)(w.a.Item,{children:Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1.7},children:[Object(I.jsxs)("span",{children:[Object(I.jsx)(L.a,{name:"star"}),"STARRED"]})," ","(",e.length,")"]})}),this.displayChannel(e)]})}}]),n}(o.Component),ne=Object(m.b)(null,{setPrivateChannel:C,setCurrentChannel:x})(te),ae=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.primaryColor,a=e.currentChannel;return Object(I.jsxs)(w.a,{size:"large",inverted:!0,fixed:"left",vertical:!0,style:{background:n,fontSize:"1.2rem"},children:[Object(I.jsx)(Z,{primaryColor:n,currentUser:t,currentChannel:a}),Object(I.jsx)(ne,{currentUser:t}),Object(I.jsx)(J,{currentUser:t}),Object(I.jsx)(X,{currentUser:t})]})}}]),n}(c.a.Component),se=n(413),re=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.channelName,n=e.numUniqueUsers,a=e.handleSearchChange,s=e.searchLoading,r=e.isPrivateChannel,i=e.handleStar,o=e.isChannelStarred;return Object(I.jsxs)(P.a,{clearing:!0,children:[Object(I.jsx)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:Object(I.jsxs)(V.a,{fluid:"true",as:"h2",floated:"left",style:{marginBottom:0},children:[Object(I.jsxs)("span",{children:[t,!r&&Object(I.jsx)(L.a,{onClick:i,name:o?"star":"star outline",color:o?"yellow":"black"})]}),Object(I.jsxs)(V.a.Subheader,{children:[" ",n]})]})}),Object(I.jsx)(A.a.div,{whileTap:{scale:1.08},children:Object(I.jsx)(V.a,{floated:"right",children:Object(I.jsx)(B.a,{loading:s,size:"mini",icon:"search",name:"searchTerm",placeholder:"Search Messages",onChange:a})})})]})}}]),n}(o.Component),ie=n(198),oe=n.n(ie),ce=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={file:null,authorized:["image/jpeg","image/png"]},e.addFile=function(t){var n=t.target.files[0];n&&e.setState({file:n})},e.sendFile=function(){var t=e.state.file,n=e.props,a=n.uploadFile,s=n.closeModal;null!==t&&(e.isAuthorized(t.name)&&(a(t,{contentType:oe.a.lookup(t.name)}),s(),e.clearFile()))},e.isAuthorized=function(t){return e.state.authorized.includes(oe.a.lookup(t))},e.clearFile=function(){return e.setState({files:null})},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.modal,n=e.closeModal;return Object(I.jsxs)(U.a,{basic:!0,open:t,onClose:n,children:[Object(I.jsx)(U.a.Header,{children:" Select an Image File "}),Object(I.jsx)(U.a.Content,{children:Object(I.jsx)(B.a,{onChange:this.addFile,fluid:!0,type:"file",name:"file",label:"File types:jpg,png"})}),Object(I.jsxs)(U.a.Actions,{children:[Object(I.jsxs)(R.a,{onClick:this.sendFile,color:"green",inverted:!0,children:[Object(I.jsx)(L.a,{name:"checkmark"})," Send"]}),Object(I.jsxs)(R.a,{color:"red",inverted:!0,onClick:n,children:[Object(I.jsx)(L.a,{name:"remove"})," Cancel"]})]})]})}}]),n}(o.Component),le=n(419),de=n(418),ue=function(e){var t=e.uploadState,n=e.percentUploaded;return"uploading"===t&&Object(I.jsx)(de.a,{className:"progress__bar",percent:n,progress:!0,indicating:!0,size:"medium",inverted:!0})},he=n(202),je=(n(387),function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={message:"",channel:e.props.currentChannel,user:e.props.currentUser,loading:!1,modal:!1,errors:[],uploadState:"",uploadTask:null,percentUploaded:0,storageRef:p.storage().ref(),typingRef:p.database().ref("typing"),emojiPicker:!1},e.openModal=function(){e.setState({modal:!0})},e.closeModal=function(){e.setState({modal:!1})},e.handleChange=function(t){e.setState(Object(T.a)({},t.target.name,t.target.value))},e.createMessage=function(){var t,n,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r={timestamp:p.database.ServerValue.TIMESTAMP,user:{id:null===(t=e.state.user)||void 0===t?void 0:t.uid,name:null===(n=e.state.user)||void 0===n?void 0:n.displayName,avatar:null===(a=e.state.user)||void 0===a?void 0:a.photoURL}};return null!==s?r.image=s:r.content=e.state.message,r},e.sendMessage=function(){var t=e.props.getMessagesRef,n=e.state,a=n.message,s=n.channel,r=n.typingRef,i=n.user;a?(e.setState({loading:!0}),t().child(null===s||void 0===s?void 0:s.id).push().set(e.createMessage()).then((function(){e.setState({loading:!1,message:"",errors:[]}),r.child(null===s||void 0===s?void 0:s.id).child(null===i||void 0===i?void 0:i.uid).remove()})).catch((function(t){console.error(t),e.setState({loading:!1,errors:e.state.errors.concat(t)})}))):e.setState({errors:e.state.errors.concat({message:"Add a Message"})})},e.getPath=function(){return e.props.isPrivateChannel?"chat/private/".concat(e.state.channel.id):"chat/public"},e.uploadFile=function(t,n){var a=e.state.channel.id,s=e.props.getMessagesRef(),r="".concat(e.getPath(),"/").concat(Object(le.a)(),".jpg");e.setState({uploadState:"uploading",uploadTask:e.state.storageRef.child(r).put(t,n)},(function(){e.state.uploadTask.on("state_changed",(function(t){var n=Math.round(t.bytesTransferred/t.totalBytes*100);e.setState({percentUploaded:n})}),(function(t){console.error(t),e.setState({errors:e.state.errors.concat(t),uploadState:"error",uploadTask:null})}),(function(){e.state.uploadTask.snapshot.ref.getDownloadURL().then((function(t){e.sendFileMessage(t,s,a)})).catch((function(t){console.error(t),e.setState({errors:e.state.errors.concat(t),uploadState:"error",uploadTask:null})}))}))}))},e.sendFileMessage=function(t,n,a){n.child(a).push().set(e.createMessage(t)).then((function(){e.setState({uploadState:"done"})})).catch((function(t){console.error(t),e.setState({errors:e.state.errors.concat(t)})}))},e.handleKeyDown=function(){var t=e.state,n=t.message,a=t.typingRef,s=t.channel,r=t.user;n?a.child(null===s||void 0===s?void 0:s.id).child(null===r||void 0===r?void 0:r.uid).set(null===r||void 0===r?void 0:r.displayName):a.child(null===s||void 0===s?void 0:s.id).child(null===r||void 0===r?void 0:r.uid).remove()},e.handleTogglePicker=function(){e.setState({emojiPicker:!e.state.emojiPicker})},e.colonToUnicode=function(e){return e.replace(/:[A-Za-z0-9_+-]+:/g,(function(e){e=e.replace(/:/g,"");var t=he.b.emojis[e];if("undefined"!==typeof t){var n=t.native;if("undefined"!==typeof n)return n}return e=":"+e+":"}))},e.handleAddEmoji=function(t){var n=e.state.message,a=e.colonToUnicode(" ".concat(n," ").concat(t.colons," "));e.setState({message:a,emojiPicker:!1}),setTimeout((function(){e.messageInputRef.focus()}),0)},e}return Object(s.a)(n,[{key:"componentWillUnmount",value:function(){null!==this.state.uploadTask&&(this.state.uploadTask.cancel(),this.setState({uploadTask:null}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.errors,a=t.message,s=t.loading,r=t.modal,i=t.uploadState,o=t.percentUploaded,c=t.emojiPicker;return Object(I.jsxs)(P.a,{className:"message__form",children:[c&&Object(I.jsx)(he.a,{set:"google",theme:"dark",onSelect:this.handleAddEmoji,className:"emojipicker",title:"Pick your Emoji",emoji:"point_up"}),Object(I.jsx)(A.a.div,{whileTap:{scale:1.02},children:Object(I.jsx)(B.a,{fluid:!0,name:"message",onKeyDown:this.handleKeyDown,ref:function(t){return e.messageInputRef=t},label:Object(I.jsx)(R.a,{icon:c?"close":"add",content:c?"Close":null,onClick:this.handleTogglePicker}),labelPosition:"left",value:a,placeholder:"write your message",style:{marginBottom:"0.8em"},onChange:this.handleChange,className:n.some((function(e){return e.message.includes("message")}))?"error":""})}),Object(I.jsxs)(R.a.Group,{icon:!0,widths:"2",children:[Object(I.jsx)(R.a,{color:"orange",content:"Add Reply",labelPosition:"left",icon:"edit",disabled:s,onClick:this.sendMessage}),Object(I.jsx)(R.a,{color:"teal",content:"Upload Media",disabled:"uploading"===i,labelPosition:"left",icon:"cloud upload",onClick:this.openModal})]}),Object(I.jsx)(ce,{modal:r,closeModal:this.closeModal,uploadFile:this.uploadFile}),Object(I.jsx)(ue,{uploadState:i,percentUploaded:o})]})}}]),n}(o.Component)),pe=n(245),me=n.n(pe),fe=function(e,t){return e.user.id===t.uid?"message__self":""},ve=function(e){return e.hasOwnProperty("image")&&!e.hasOwnProperty("content")},ge=function(e){var t,n,a,s=e.message,r=e.user;return Object(I.jsx)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,type:"tween"},children:Object(I.jsxs)(se.a,{children:[Object(I.jsx)(se.a.Avatar,{src:null===(t=s.user)||void 0===t?void 0:t.avatar}),Object(I.jsxs)(se.a.Content,{className:fe(s,r),children:[Object(I.jsx)(se.a.Author,{as:"a",children:null===(n=s.user)||void 0===n?void 0:n.name}),Object(I.jsx)(se.a.Metadata,{children:(a=s.timestamp,me()(a).fromNow())}),ve(s)?Object(I.jsx)(z.a,{src:s.image,className:"message__image"}):Object(I.jsx)(se.a.Text,{children:s.content})]})]})})},be=function(){return Object(I.jsxs)("div",{className:"typing",children:[Object(I.jsx)("div",{className:"typing__dot"}),Object(I.jsx)("div",{className:"typing__dot"}),Object(I.jsx)("div",{className:"typing__dot"})]})},Oe=function(){return Object(I.jsxs)("div",{className:"skeleton",children:[Object(I.jsx)("div",{className:"skeleton__avatar",children:" "}),Object(I.jsx)("div",{className:"skeleton__author",children:" "}),Object(I.jsx)("div",{className:"skeleton__details",children:" "})]})},ye=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={messagesRef:p.database().ref("messages"),usersRef:p.database().ref("users"),privateMessagesRef:p.database().ref("privateMessages"),privateChannel:e.props.isPrivateChannel,channel:e.props.currentChannel,user:e.props.currentUser,messages:[],messagesLoading:!0,numUniqueUsers:"",searchTerm:"",isChannelStarred:!1,searchLoading:!1,searchResults:[],typingUsers:[],listeners:[],typingRef:p.database().ref("typing"),connectedRef:p.database().ref(".info/connected")},e.scrollToBottom=function(){e.messageEnd.scrollIntoView({behavior:"smooth"})},e.removeListeners=function(e){e.forEach((function(e){e.ref.child(e.id).off(e.event)}))},e.addToListeners=function(t,n,a){if(-1!==e.state.listeners.findIndex((function(e){return e.id===t&&e.ref===n&&e.event===a}))){var s={id:t,ref:n,event:a};e.setState({listeners:e.state.listeners.concat(s)})}},e.addListeners=function(t){e.addMessageListener(t),e.addTypingListener(t)},e.addTypingListener=function(t){var n=[];e.state.typingRef.child(t).on("child_added",(function(t){var a;t.key!==(null===(a=e.state.user)||void 0===a?void 0:a.uid)&&(n=n.concat({id:t.key,name:t.val()}),e.setState({typingUsers:n}))})),e.addToListeners(t,e.state.typingRef,"child_added"),e.state.typingRef.child(t).on("child_removed",(function(t){-1!==n.findIndex((function(e){return t.key===e.uid}))&&(n=n.filter((function(e){return e.id!==t.key})),e.setState({typingUsers:n}))})),e.addToListeners(t,e.state.typingRef,"child_removed"),e.state.connectedRef.on("value",(function(n){var a;!0===n.val()&&e.state.typingRef.child(t).child(null===(a=e.state.user)||void 0===a?void 0:a.uid).onDisconnect().remove((function(e){null!==e&&console.error(e)}))}))},e.addMessageListener=function(t){var n=[],a=e.getMessagesRef();a.child(t).on("child_added",(function(t){n.push(t.val()),e.setState({messages:n,messagesLoading:!1}),e.countUniqueUsers(n),e.countUserPosts(n)})),e.addToListeners(t,a,"child_added")},e.getMessagesRef=function(){var t=e.state,n=t.privateChannel,a=t.messagesRef,s=t.privateMessagesRef;return n?s:a},e.countUniqueUsers=function(t){var n=t.reduce((function(e,t){return e.includes(t.user.id)||e.push(t.user.id),e}),[]),a=n.length>1||0===n.length,s="".concat(n.length," User").concat(a?"s":"");e.setState({numUniqueUsers:s})},e.countUserPosts=function(t){var n=t.reduce((function(e,t){return t.user.id in e?e[t.user.id].count+=1:e[t.user.id]={avatar:t.user.avatar,count:1,name:t.user.name},e}),{});e.props.setUserPosts(n)},e.handleSearchChange=function(t){e.setState({searchTerm:t.target.value,searchLoading:!0},(function(){return e.handleSearchMessages()}))},e.handleSearchMessages=function(){var t=Object(Y.a)(e.state.messages),n=new RegExp(e.state.searchTerm,"gi"),a=t.reduce((function(e,t){return(t.content&&t.content.match(n)||t.user.name.match(n))&&e.push(t),e}),[]);e.setState({searchResults:a}),setTimeout((function(){return e.setState({searchLoading:!1})}),1e3)},e.displayMessages=function(t){return t.length>0&&t.map((function(t){return Object(I.jsx)(ge,{message:t,user:e.state.user},t.timestamp)}))},e.displayChannelName=function(t){return t?"".concat(e.state.privateChannel?"@":"#").concat(t.name):""},e.handleStar=function(){e.setState((function(e){return{isChannelStarred:!e.isChannelStarred}}),(function(){return e.starChannel()}))},e.starChannel=function(){var t,n;e.state.isChannelStarred?e.state.usersRef.child("".concat(null===(t=e.state.user)||void 0===t?void 0:t.uid,"/starred")).update(Object(T.a)({},e.state.channel.id,{name:e.state.channel.name,details:e.state.channel.details,createdBy:{name:e.state.channel.createdBy.name,avatar:e.state.channel.createdBy.avatar}})):e.state.usersRef.child("".concat(null===(n=e.state.user)||void 0===n?void 0:n.uid,"/starred")).child(e.state.channel.id).remove((function(e){null!==e&&console.error(e)}))},e.addUserStarsListener=function(t,n){e.state.usersRef.child(n).child("starred").once("value").then((function(n){if(null!==n.val()){var a=Object.keys(n.val()).includes(t);e.setState({isChannelStarred:a})}}))},e.displayTypingUsers=function(e){return e.length>0&&e.map((function(e){return Object(I.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.2em"},children:[Object(I.jsxs)("span",{className:"user__typing",children:[null===e||void 0===e?void 0:e.name," is typing "]})," ",Object(I.jsx)(be,{})]},e.id)}))},e.displayMessagesSkeleton=function(e){return e?Object(I.jsx)(I.Fragment,{children:Object(Y.a)(Array(10)).map((function(e,t){return Object(I.jsx)(Oe,{},t)}))}):null},e}return Object(s.a)(n,[{key:"componentDidUpdate",value:function(e,t){this.messageEnd&&this.scrollToBottom()}},{key:"componentDidMount",value:function(){var e=this.state,t=e.channel,n=e.user,a=e.listeners;t&&n&&(this.removeListeners(a),this.addListeners(null===t||void 0===t?void 0:t.id),this.addUserStarsListener(null===t||void 0===t?void 0:t.id,null===n||void 0===n?void 0:n.uid))}},{key:"componentWillUnmount",value:function(){this.removeListeners(this.state.listeners),this.state.connectedRef.off()}},{key:"render",value:function(){var e=this,t=this.state,n=t.messagesRef,a=t.messages,s=t.channel,r=t.user,i=t.numUniqueUsers,o=t.searchResults,c=t.searchTerm,l=t.searchLoading,d=t.privateChannel,u=t.isChannelStarred,h=t.typingUsers,j=t.messagesLoading;return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(re,{channelName:this.displayChannelName(s),numUniqueUsers:i,handleSearchChange:this.handleSearchChange,searchLoading:l,isPrivateChannel:d,isChannelStarred:u,handleStar:this.handleStar,handleChange:this.handleChange}),Object(I.jsx)(P.a,{children:Object(I.jsxs)(se.a.Group,{className:"messages",children:[this.displayMessagesSkeleton(j),c?this.displayMessages(o):this.displayMessages(a),this.displayTypingUsers(h),Object(I.jsx)("div",{ref:function(t){return e.messageEnd=t}})]})}),Object(I.jsx)(je,{messagesRef:n,currentChannel:s,currentUser:r,isPrivateChannel:d,getMessagesRef:this.getMessagesRef})]})}}]),n}(c.a.Component),xe=Object(m.b)(null,{setUserPosts:function(e){return{type:O,payload:{userPosts:e}}}})(ye),Ce=n(248),Se=n(415),ke=n(416),we=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={channel:e.props.currentChannel,isPrivateChannel:e.props.isPrivateChannel,activeIndex:0},e.setActiveIndex=function(t,n){var a=n.index,s=e.state.activeIndex===a?-1:a;e.setState({activeIndex:s})},e.displayTopPosters=function(t){return Object.entries(t).sort((function(e,t){return e[1]-t[1]})).map((function(t,n){var a=Object(Ce.a)(t,2),s=(a[0],a[1]);return Object(I.jsxs)(Se.a.Item,{children:[Object(I.jsx)(z.a,{avatar:!0,src:s.avatar}),Object(I.jsxs)(Se.a.Content,{children:[Object(I.jsx)(Se.a.Header,{as:"a",children:s.name}),Object(I.jsx)(Se.a.Description,{children:e.formatCount(s.count)})]})]},n)})).reverse().slice(0,5)},e.formatCount=function(e){return"".concat(e,e>1||0===e?" Posts":" Post")},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state,t=e.activeIndex,n=e.isPrivateChannel,a=e.channel,s=this.props.userPosts;return n?null:Object(I.jsxs)(P.a,{loading:!a,children:[Object(I.jsxs)(V.a,{as:"h3",attached:"top",children:["About # ",a&&a.name]}),Object(I.jsxs)(ke.a,{styled:!0,attached:"true",children:[Object(I.jsxs)(ke.a.Title,{active:0===t,index:0,onClick:this.setActiveIndex,children:[Object(I.jsx)(L.a,{name:"dropdown"}),Object(I.jsx)(L.a,{name:"info"}),"Channel Details"]}),Object(I.jsx)(ke.a.Content,{active:0===t,children:a&&a.details}),Object(I.jsxs)(ke.a.Title,{active:1===t,index:1,onClick:this.setActiveIndex,children:[Object(I.jsx)(L.a,{name:"dropdown"}),Object(I.jsx)(L.a,{name:"user circle"}),"Top Posters"]}),Object(I.jsx)(ke.a.Content,{active:1===t,children:Object(I.jsx)(Se.a,{children:s&&this.displayTopPosters(s)})}),Object(I.jsxs)(ke.a.Title,{active:2===t,index:2,onClick:this.setActiveIndex,children:[Object(I.jsx)(L.a,{name:"dropdown"}),Object(I.jsx)(L.a,{name:"pencil alternate"}),"Created By"]}),Object(I.jsx)(ke.a.Content,{active:2===t,children:Object(I.jsxs)(V.a,{as:"h3",children:[Object(I.jsx)(z.a,{circular:!0,src:a&&a.createdBy.avatar})," ",Object(I.jsx)("strong",{children:a&&a.createdBy.name})]})})]})]})}}]),n}(c.a.Component),Re=Object(m.b)((function(e){return{currentUser:e.user.currentUser,currentChannel:e.channel.currentChannel,isPrivateChannel:e.channel.isPrivateChannel,userPosts:e.channel.userPosts,primaryColor:e.colors.primaryColor,secondaryColor:e.colors.secondaryColor}}))((function(e){var t=e.currentUser,n=e.currentChannel,a=e.isPrivateChannel,s=e.userPosts,r=e.primaryColor,i=e.secondaryColor;return Object(I.jsxs)(u.a,{columns:"equal",className:"app",style:{background:i},children:[Object(I.jsx)(_,{currentUser:t},t&&t.name),Object(I.jsx)(ae,{currentUser:t,primaryColor:r,currentChannel:n},t&&t.uid),Object(I.jsx)(u.a.Column,{style:{marginLeft:320},children:Object(I.jsx)(xe,{currentChannel:n,currentUser:t,isPrivateChannel:a},n&&n.id)}),Object(I.jsx)(u.a.Column,{width:4,children:Object(I.jsx)(we,{currentChannel:n,isPrivateChannel:a,userPosts:s},n&&n.name)})]})})),Ue=n(65),Pe=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={email:"",password:"",errors:[],loading:!1,loading2:!1,usersRef:p.database().ref("users")},e.displayErrors=function(e){return e.map((function(e,t){return Object(I.jsx)("p",{children:e.message},t)}))},e.handleChange=function(t){e.setState(Object(T.a)({},t.target.name,t.target.value))},e.handleSubmit=function(t){t.preventDefault(),e.isFormValid()&&(e.setState({errors:[],loading:!0}),p.auth().signInWithEmailAndPassword(e.state.email,e.state.password).then((function(e){return console.log(e)})).catch((function(t){console.log(t),e.setState({errors:e.state.errors.concat(t),loading:!1})})))},e.isFormValid=function(){var t;return!e.isFormEmpty(e.state)||(t={message:"Fill in all fields"},e.setState({errors:[].concat(t)}),!1)},e.isFormEmpty=function(e){var t=e.email,n=e.password;return!t.length||!n.length},e.handleInputError=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t)}))?"error":""},e.saveUser=function(t){var n,a,s;return e.state.usersRef.child(null===(n=t.user)||void 0===n?void 0:n.uid).set({name:null===(a=t.user)||void 0===a?void 0:a.displayName,avatar:null===(s=t.user)||void 0===s?void 0:s.photoURL})},e.googleLogin=function(t){t.preventDefault(),p.auth().signInWithPopup(j).then((function(t){return e.saveUser(t)})).catch((function(t){console.log(t),e.setState({errors:e.state.errors.concat(t),loading2:!1})}))},e.iconVariants={hidden:{opacity:.5},hover:{scale:1.1},visible:{opacity:1,scale:[1,1.3,1.3,1,1],rotate:[0,0,270,270,0],transition:{delay:.5,duration:2,yoyo:1/0}}},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,a=e.errors,s=e.loading,r=e.loading2;return Object(I.jsx)(u.a,{textAlign:"center",verticalAlign:"middle",className:"app_auth",children:Object(I.jsxs)(u.a.Column,{style:{maxWidth:450},children:[Object(I.jsxs)(V.a,{as:"h1",icon:!0,color:"violet",textAlign:"center",children:[Object(I.jsx)(A.a.div,{variants:this.iconVariants,initial:"hidden",animate:"visible",children:Object(I.jsx)(z.a,{src:G,centered:!0,className:"slack__img"})}),Object(I.jsx)(A.a.div,{initial:{opacity:0,x:"100vw"},animate:{opacity:1,x:0},transition:{type:"spring",delay:1,duration:2,stiffness:120},children:Object(I.jsx)("span",{className:"l_color",children:"Login for Notify-Slack"})})]}),Object(I.jsxs)(A.a.div,{initial:{x:"-100vw"},animate:{x:0},transition:{type:"spring",delay:1.5,duration:2},children:[Object(I.jsx)(H.a,{onSubmit:this.handleSubmit,size:"large",children:Object(I.jsxs)(P.a,{stacked:!0,children:[Object(I.jsx)(H.a.Input,{fluid:!0,name:"email",icon:"mail",iconPosition:"left",placeholder:"Email Address",onChange:this.handleChange,value:t,className:this.handleInputError(a,"email"),type:"email"}),Object(I.jsx)(H.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",onChange:this.handleChange,value:n,className:this.handleInputError(a,"password"),type:"password"}),Object(I.jsx)("p",{children:Object(I.jsx)(A.a.div,{whileHover:{scale:1.1},children:Object(I.jsx)(Ue.b,{to:"/forgot-password",children:"Forgot Password?"})})}),Object(I.jsx)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},children:Object(I.jsx)(R.a,{disabled:s,className:s?"loading":"",color:"violet",fluid:!0,size:"large",children:"Login"})}),Object(I.jsx)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},children:Object(I.jsx)(R.a,{disabled:r,onClick:this.googleLogin,className:r?"loading":"",style:{marginTop:"1em"},color:"orange",fluid:!0,size:"large",icon:"google",labelPosition:"left",content:"Login With Google"})})]})}),a.length>0&&Object(I.jsx)(A.a.div,{style:{marginTop:"1rem"},initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:Object(I.jsx)(q.a,{error:!0,children:Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[Object(I.jsx)("h3",{children:"Error"}),this.displayErrors(a)]})})}),Object(I.jsx)(q.a,{children:Object(I.jsxs)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},children:[" ","New Here? ",Object(I.jsx)(Ue.b,{to:"/register",children:" Register "})," "]})})]})]})})}}]),n}(c.a.Component),Ne=n(246),Le=n.n(Ne),Ee=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={username:"",email:"",password:"",passwordConfirmation:"",errors:[],loading:!1,loading2:!1,usersRef:p.database().ref("users"),userRef:p.auth().currentUser,message:null},e.isFormValid=function(){var t,n=[];return e.isFormEmpty(e.state)?(t={message:"Fill in all fields"},e.setState({errors:n.concat(t)}),!1):e.isPasswordValid(e.state)?!!e.isEmailValid(e.state)||(t={message:"Email is invalid"},e.setState({errors:n.concat(t)}),!1):(t={message:"Password is invalid"},e.setState({errors:n.concat(t)}),!1)},e.isEmailValid=function(e){return!!e.email.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)},e.isFormEmpty=function(e){var t=e.username,n=e.email,a=e.password,s=e.passwordConfirmation;return!t.length||!n.length||!a.length||!s.length},e.isPasswordValid=function(e){var t=e.password,n=e.passwordConfirmation;return!(t.length<6||n.length<6)&&t===n},e.displayErrors=function(e){return e.map((function(e,t){return Object(I.jsx)("p",{children:e.message},t)}))},e.handleChange=function(t){e.setState(Object(T.a)({},t.target.name,t.target.value))},e.handleSubmit=function(t){t.preventDefault(),e.isFormValid()&&(e.setState({errors:[],loading:!0}),p.auth().createUserWithEmailAndPassword(e.state.email,e.state.password).then((function(t){var n;e.setState({message:null}),console.log(t),t.user.updateProfile({displayName:e.state.username,photoURL:"http://gravatar.com/avatar/".concat(Le()(null===(n=t.user)||void 0===n?void 0:n.email),"?d=identicon")}).then((function(){e.saveUser(t).then((function(){console.log("user saved")}))})).catch((function(t){console.log(t),e.setState({errors:e.state.errors.concat(t),loading:!1})}))})).catch((function(t){console.error(t),e.setState({errors:e.state.errors.concat(t),loading:!1})})))},e.handleInputError=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t)}))?"error":""},e.saveUser=function(t){var n,a,s;return e.state.usersRef.child(null===(n=t.user)||void 0===n?void 0:n.uid).set({name:null===(a=t.user)||void 0===a?void 0:a.displayName,avatar:null===(s=t.user)||void 0===s?void 0:s.photoURL})},e.googleLogin=function(t){t.preventDefault(),e.setState({loading2:!0}),p.auth().signInWithPopup(j).then((function(t){e.saveUser(t)})).catch((function(t){console.log(t),e.setState({errors:e.state.errors.concat(t),loading2:!1})}))},e.iconVariants={hidden:{opacity:.5},hover:{scale:1.1},visible:{opacity:1,scale:[1,1.3,1.3,1,1],rotate:[0,0,270,270,0],transition:{delay:.5,duration:2,yoyo:1/0}}},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.email,a=e.password,s=e.passwordConfirmation,r=e.errors,i=e.loading,o=e.loading2,c=e.message;return Object(I.jsx)(u.a,{textAlign:"center",verticalAlign:"middle",className:"app_auth",children:Object(I.jsxs)(u.a.Column,{style:{maxWidth:450},children:[Object(I.jsxs)(V.a,{as:"h1",icon:!0,color:"blue",textAlign:"center",children:[Object(I.jsx)(A.a.div,{variants:this.iconVariants,initial:"hidden",animate:"visible",children:Object(I.jsx)(z.a,{src:G,centered:!0,className:"slack__img"})}),Object(I.jsx)(A.a.div,{initial:{opacity:0,x:"100vw"},animate:{opacity:1,x:0},transition:{type:"spring",delay:1,duration:2,stiffness:120},children:Object(I.jsx)("span",{className:"l_color",children:"Register for Notify-Slack"})})]}),Object(I.jsxs)(A.a.div,{initial:{x:"-100vw"},animate:{x:0},transition:{type:"spring",delay:1.5,duration:2},children:[Object(I.jsx)(H.a,{onSubmit:this.handleSubmit,size:"large",children:Object(I.jsxs)(P.a,{stacked:!0,children:[Object(I.jsx)(H.a.Input,{fluid:!0,name:"username",icon:"user",iconPosition:"left",placeholder:"Username",onChange:this.handleChange,value:t,type:"text"}),Object(I.jsx)(H.a.Input,{fluid:!0,name:"email",icon:"mail",iconPosition:"left",placeholder:"Email Address",onChange:this.handleChange,value:n,className:this.handleInputError(r,"email"),type:"email"}),Object(I.jsx)(H.a.Input,{fluid:!0,name:"password",icon:"lock",iconPosition:"left",placeholder:"Password",onChange:this.handleChange,value:a,className:this.handleInputError(r,"password"),type:"password"}),Object(I.jsx)(H.a.Input,{fluid:!0,name:"passwordConfirmation",icon:"repeat",iconPosition:"left",placeholder:"Password Confirmation",onChange:this.handleChange,value:s,className:this.handleInputError(r,"password"),type:"password"}),Object(I.jsx)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},children:Object(I.jsx)(R.a,{disabled:i,className:i?"loading":"",color:"blue",fluid:!0,size:"large",children:"Register"})}),Object(I.jsx)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},children:Object(I.jsx)(R.a,{disabled:o,onClick:this.googleLogin,className:o?"loading":"",style:{marginTop:"1em"},color:"orange",fluid:!0,size:"large",icon:"google",labelPosition:"left",content:"Register With Google"})})]})}),null!==c&&Object(I.jsx)(q.a,{message:!0,children:c}),r.length>0&&Object(I.jsx)(A.a.div,{style:{marginTop:"1rem"},initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:Object(I.jsx)(q.a,{error:!0,children:Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[Object(I.jsx)("h3",{children:"Error"}),this.displayErrors(r)]})})}),Object(I.jsx)(q.a,{children:Object(I.jsxs)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},children:["Already an user?",Object(I.jsx)(Ue.b,{to:"/login",children:" Login "})]})})]})]})})}}]),n}(c.a.Component),Ae=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ie(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(391);var Me=n(25),_e=n(93),Te={currentUser:null,isLoading:!0},Fe={currentChannel:null,isPrivateChannel:!1,userPosts:null},De={primaryColor:"#0d47a1",secondaryColor:"#eee"},Ve=Object(_e.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return{currentUser:t.payload.currentUser,isLoading:!1};case v:return Object(ee.a)(Object(ee.a)({},e),{},{isLoading:!1});default:return e}},channel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(ee.a)(Object(ee.a)({},e),{},{currentChannel:t.payload.currentChannel});case b:return Object(ee.a)(Object(ee.a)({},e),{},{isPrivateChannel:t.payload.isPrivateChannel});case O:return Object(ee.a)(Object(ee.a)({},e),{},{userPosts:t.payload.userPosts});default:return e}},colors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return{primaryColor:t.payload.primaryColor,secondaryColor:t.payload.secondaryColor};default:return e}}}),ze=n(247),We=n(422),Be=n(408),He=function(){return Object(I.jsxs)(We.a,{active:!0,children:[Object(I.jsx)(Be.a,{size:"huge",content:"Preparing Chat..."})," "]})},qe=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={email:"",errors:[],message:[],loading:!1},e.displayErrors=function(e){return e.map((function(e,t){return Object(I.jsx)("p",{children:e.message},t)}))},e.handleChange=function(t){e.setState(Object(T.a)({},t.target.name,t.target.value))},e.resetPassword=function(t){t.preventDefault(),e.isFormValid(e.state)&&(e.setState({errors:[],loading:!0}),p.auth().sendPasswordResetEmail(e.state.email).then(e.setState({message:"Check Your Inbox",loading:!1})).catch((function(t){console.log(t),e.setState({errors:e.state.errors.concat(t),loading:!1})})))},e.isFormValid=function(e){return!!e.email},e.handleInputError=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t)}))?"error":""},e.iconVariants={hidden:{opacity:.5},hover:{scale:1.1},visible:{opacity:1,scale:[1,1.3,1.3,1,1],rotate:[0,0,270,270,0],transition:{delay:.5,duration:2,yoyo:1/0}}},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.errors,a=e.loading,s=e.message;return Object(I.jsx)(u.a,{textAlign:"center",verticalAlign:"middle",className:"app_auth",children:Object(I.jsxs)(u.a.Column,{style:{maxWidth:450},children:[Object(I.jsxs)(V.a,{as:"h1",icon:!0,color:"violet",textAlign:"center",children:[Object(I.jsx)(A.a.div,{variants:this.iconVariants,initial:"hidden",animate:"visible",children:Object(I.jsx)(L.a,{name:"key",color:"teal"})}),Object(I.jsx)(A.a.div,{initial:{opacity:0,x:"100vw"},animate:{opacity:1,x:0},transition:{type:"spring",delay:1,duration:2,stiffness:120},children:Object(I.jsx)("span",{style:{color:"red"},children:"Password Reset"})})]}),Object(I.jsxs)(A.a.div,{initial:{x:"-100vw"},animate:{x:0},transition:{type:"spring",delay:1.5,duration:2},children:[Object(I.jsx)(H.a,{size:"large",onSubmit:this.resetPassword,children:Object(I.jsxs)(P.a,{stacked:!0,children:[Object(I.jsx)(H.a.Input,{fluid:!0,name:"email",icon:"mail",iconPosition:"left",placeholder:"Email Address",onChange:this.handleChange,value:t,className:this.handleInputError(n,"email"),type:"email"}),Object(I.jsx)(A.a.div,{whileHover:{scale:1.05},children:Object(I.jsx)(R.a,{disabled:a,className:a?"loading":"",color:"red",fluid:!0,size:"large",children:"Reset Password"})}),Object(I.jsxs)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},style:{marginTop:"1rem"},children:["Back to Login ",Object(I.jsx)(Ue.b,{to:"/login",children:"Login"})]})]})}),n.length>0&&Object(I.jsx)(A.a.div,{style:{marginTop:"1rem"},initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:Object(I.jsx)(q.a,{error:!0,children:Object(I.jsxs)(A.a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:[Object(I.jsx)("h3",{children:"Error"}),this.displayErrors(n)]})})}),s.length>0&&Object(I.jsx)(q.a,{message:!0,children:s}),Object(I.jsx)(q.a,{children:Object(I.jsxs)(A.a.div,{whileHover:{scale:1.05},transition:{duration:.3},children:["New Here? ",Object(I.jsx)(Ue.b,{to:"/register",children:" Register "})]})})]})]})})}}]),n}(c.a.Component),Ge=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var s=arguments.length,r=new Array(s),i=0;i<s;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={message:[]},e.sendVerification=function(){p.auth().currentUser.sendEmailVerification().then((function(){e.setState({message:"Email has been sent Successfully"})})).catch((function(e){return console.error(e)}))},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state.message;return Object(I.jsx)(u.a,{textAlign:"center",verticalAlign:"middle",className:"app_auth",children:Object(I.jsxs)(u.a.Column,{style:{maxWidth:450},children:[Object(I.jsx)(V.a,{as:"h1",icon:!0,color:"blue",textAlign:"center",children:Object(I.jsx)(L.a,{name:"envelope outline",color:"blue"})}),Object(I.jsxs)(P.a,{stacked:!0,children:[Object(I.jsx)("h2",{className:"r_color",children:"Verify Your Email"}),Object(I.jsx)("p",{children:"Click here to send verification"}),Object(I.jsx)(R.a,{color:"blue",fluid:!0,size:"large",onClick:this.sendVerification,children:"Send Verification"})]}),e.length>0&&Object(I.jsx)(q.a,{message:!0,children:e})]})})}}]),n}(o.Component),Ke=Object(_e.createStore)(Ve,Object(ze.composeWithDevTools)()),Ze=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;p.auth().onAuthStateChanged((function(t){t?(e.props.setUser(t),e.props.history.push("/")):(e.props.history.push("/login"),e.props.clearUser())}))}},{key:"render",value:function(){return this.props.isLoading?Object(I.jsx)(He,{}):Object(I.jsxs)(Me.c,{children:[Object(I.jsx)(Me.a,{exact:!0,path:"/",component:Re}),Object(I.jsx)(Me.a,{path:"/login",component:Pe}),Object(I.jsx)(Me.a,{path:"/register",component:Ee}),Object(I.jsx)(Me.a,{path:"/forgot-password",component:qe}),Object(I.jsx)(Me.a,{path:"/verify-email",component:Ge})]})}}]),n}(c.a.Component),Ye=Object(Me.f)(Object(m.b)((function(e){return{isLoading:e.user.isLoading}}),{setUser:function(e){return{type:f,payload:{currentUser:e}}},clearUser:function(){return{type:v}}})(Ze));d.a.render(Object(I.jsx)(m.a,{store:Ke,children:Object(I.jsx)(Ue.a,{children:Object(I.jsx)(Ye,{})})}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");Ae?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ie(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Ie(e)}))}}()}},[[392,1,2]]]);
//# sourceMappingURL=main.ddfda4e3.chunk.js.map